---
title: "Influenza A and B Supepidemic Analysis"
author: "Jake Harmon"
format: docx
bibliography: references.bib
execute: 
  warning: false
  echo: false
---

```{r}
#Load Packages
library(tidyverse)
library(readr)
library(viridis) 
library(flextable)
```

## Introduction

Influenza in humans can come in two types - A and B - which are further divided into subtypes such as H1N1/H3N2 or Victoria/Yamagata respectively [@cdcPeopleIncreasedRisk2025]. These subtypes come in various strains, which, compete with each other and subside as new strains emerge. This is theorized to occur because of novel antigen-responses producing cross-immunity against currently circulating viruses [@paleseWhyInfluenzaVirus2011]. Following the COVID-19 Pandemic, global influenza surveillance systems have not detected meaningful circulation of B-Yamagata, thus leading to increased prevalence of IAV. As a result, the WHO changed its recommendations from quadrivalent to trivalent flu vaccines in 2023 [@delriccioHowHasDisappearance2025].

Influenza as a whole is a costly, contagious virus which in the United States results in over 300,000 annual hospitalizations as well as tens of thousands of death each year; a 2018 study estimated the annual cost to the American healthcare system to be \$11.2 billion annually [@putriEconomicBurdenSeasonal2018].

Hospitalization generally arises from complications developed during the course of the illness. This is commonly due to preexisting respiratory conditions or others such immune, liver, or blood conditions; CDC reports that, in recent years, roughly nine out of ten hospitalized cases had at least one preexisting condition [@cdcPeopleIncreasedRisk2025]. A meta analysis analyzing studies from both High Income and Low-Middle Income Countries found that children and young people were at significantly less risk than the elderly for hospitalization or severe outcomes such as ICU admittance or death [@colemanRiskFactorsSerious2018]. Vaccines are effective at reducing the risk of complications across all age groups, although the efficacy varies based on the predominant viral subtypes as vaccines are formulated to only protect against the expected strands [@trombettaInfluenzaVirusesVaccines2022].

Currently, a global effort is being led by the WHO to combat influenza by increasing surveillance and laboratory capacity, as well as by conducting effective vaccination campaigns [@cdcCDCsGlobalInfluenza2024]. This international collaboration relies on nations freely sharing laboratory tests of strands to identify the prevalence of influenza subtypes across the world, as this information is passed onto vaccine manufacturers to produce effective vaccines. This system is fragile, and it is easily disrupted - as seen earlier in 2025 when, admist an H5N1 outbreak in America, CDC ceased sharing data with the WHO [@maxmenUrgentCDCData2025]. All further efforts against influenza rely on the free flow of data to develop effective vaccines as well as develop appropriate policy.

Influenza forecasting can inform public health's decision making capacity, even down to the local level by determining the warrant for school closures or optimizing placement of healthcare workers to deal with peaks of cases [@WhyCDCSupports2023]. A variety of forecasting efforts have been used in the past to inform early-response efforts, to various degrees of success. In 2013, Google Flu Trends attempted to predict influenza cases by harnessing the big data of symptom searches on Google, and yet its predictions invariably skewed higher than CDC data over 100/108 weeks [@lazerParableGoogleFlu2014]. During the same time period, CDC began the FluSight program, inviting academic partners to analyze ILINet data and compete to produce the most accurate forecast. This project has proved much more successful, although it was at times impacted by reporting delays [@reichCollaborativeMultiyearMultimodel2019].

This paper looks to analyze the difference between Influenza A (IAV) and Influenza B (IBV) trends, as they have noted different temporalities in the United States, where IAV is noted to peak in December while IBV peaks around February. This can be seen especially in pediatric cases, where IBV resulted in \~ 40 % of deaths in the 2023-2024 flu season, all concentrated after January [@cdcInfluenzaActivityUnited2024]. This comes at a time as well when IBV has been varying in its temporality: [@borcheringAnomalousInfluenzaSeasonality2021].

Goal: analyze SIRC model - crossimunity [@liDYNAMICSSIRCEPIDEMIOLOGICAL] [@laurieEvidenceViralInterference2018] B dynamics

---
title: "Two-Strain SIRV Model Specification"
format: html
---

## Model Equations

The system of Ordinary Differential Equations (ODEs) used for the identifiability analysis is defined as:

$$
\begin{aligned}
\frac{dS}{dt} &= \Lambda 
- \frac{\beta_1 S I_1}{N_0} 
- \frac{\beta_2 S I_2}{N_0} 
- \alpha S 
- \mu S, \\[6pt]
\frac{dI_1}{dt} &= 
\frac{\beta_1 (S + \sigma_{21} R_2) I_1}{N_0}
- (\mu + \gamma_1) I_1, \\[6pt]
\frac{dI_2}{dt} &= 
\frac{\beta_2 (S + \sigma_{12} R_1) I_2}{N_0}
- (\mu + \gamma_2) I_2, \\[6pt]
\frac{dR_1}{dt} &= 
\gamma_1 I_1 - \mu R_1, \\[6pt]
\frac{dR_2}{dt} &= 
\gamma_2 I_2 - \mu R_2, \\[6pt]
\frac{dV}{dt} &= 
\alpha S - \mu V.
\end{aligned}
$$


**Julia Structural Identifiability**

```{r}
#| label: identifiability-table
#| echo: false
#| message: false

# Load necessary R libraries
library(jsonlite)
library(dplyr)
library(knitr)

results_filename <- "/Users/jake/Documents/PH8280_id_modeling/manuscript/data/sirv_identifiability_final.json"

# Load the JSON data
results_list <- fromJSON(results_filename)

# Convert the list into a data frame
results_df <- data.frame(
  Component = names(results_list),
  Status = unlist(results_list)
) |>
  # Clean up the output status
  mutate(Status = stringr::str_to_title(Status))

# Display the table using kable
knitr::kable(
  results_df,
  caption = "Final Global Identifiability Assessment for SIRV Model",
  col.names = c("Component (State/Parameter)", "Identifiability Status")
)
```

## Model Parameters

```{r}
# Define the Parameter Mapping Data Frame
param_map_df <- tribble(
  ~ODE_Parameter, ~Description, ~Prior_Distribution, ~Citation,
  "$\\Lambda$", "Birth/Inflow Rate", "Fixed at 0", "Fixed (Keeling & Rohani, 2008)",
  "$\\beta_1, \\beta_2$", "Transmission Rates", "lognormal(log(0.4), 0.5)", "Biggerstaff et al. (2014)",
  "$\\mu$", "Natural Death Rate", "Fixed at $3.9\\mathrm{e}^{-5}$", "Standard Demographics (e.g., CDC)",
  "$\\gamma_1, \\gamma_2$", "Recovery Rates", "normal(0.25, 0.05)T[0,]", "Carrat et al. (2008)",
  "$\\nu$", "Vaccination Rate", "normal(0.0019, 0.0006)T[0,]", "CDC (2024)",
  "$N_0$", "Initial Population", "Fixed at $1\\mathrm{e}^{6}$", "Fixed Constant",
  "$I_0$", "Initial Infected", "lognormal(log(10), 1.0)", "Initial Condition (Fitted)",
  "$\\rho$", "Reporting Fraction", "beta(2, 4)", "McCarthy et al. (2020)"
)

# Optional: Render the table for display
knitr::kable(
  param_map_df,
  caption = "Model Parameter Mapping, Priors, and Sources",
  col.names = c("ODE Parameter", "Description", "Prior Distribution", "Citation / Source"),
  escape = FALSE 
)
```

**Composite expressions:**

$$
\begin{aligned}
R_{0,1} &= \frac{\beta_1}{\gamma_1 + \delta_1 + \mu}, \\
R_{0,2} &= \frac{\beta_2}{\gamma_2 + \delta_2 + \mu}, \\
\text{VaccinationRate} &= \delta_1 + \delta_2
\end{aligned}
$$

## Parameters: 2024 Flu Season

```{r}
output_name <- "SIRV_two_strain-Influenza-negativebinomial-cal-17-fcst-10"

parameters <- readxl::read_excel(paste0("/Users/jake/Documents/PH8280_id_modeling/manuscript/data/BayesianFitForecast/output/", output_name, "/parameters-", output_name, ".xlsx"))

flextable::flextable(parameters)
```

## Citations
